<krpano version="1.23" title="Virtual Tour">
<include url="skin/vtourskin.xml"/>
<include url="%VIEWER%/plugins/contextmenu.xml" />
<include url="%VIEWER%/plugins/copy_to_clipboard.xml" />

<plugin api="gyro" keep="true"
        url="%VIEWER%/plugins/gyro2.js" 
        enabled="false"
        camroll="true"
        absolute="false"
        north="0"
        friction="0.0"
        touch_mode="full"
        sensor="1"
        sensor_mode="1"
        softstart="0.5"
        autocalibration="false"
        desktopsupport="false"
        onavailable=""
        onunavailable=""
        onenable=""
        ondisable=""
        ondenied=""
        />
<!--  customize skin settings: maps, gyro, webvr, thumbnails, tooltips, layout, design, ...  -->
    <skin_settings maps="false"
	               maps_type="openstreetmaps"
	               maps_bing_api_key=""
	               maps_google_api_key=""
	               maps_zoombuttons="false"
	               maps_loadonfirstuse="false"
	               gyro="true"
	               gyro_keeplookingdirection="false"
	               webvr="false"
	               webvr_keeplookingdirection="true"
	               webvr_prev_next_hotspots="true"
	               autotour="false"
	               littleplanetintro="false"
	               followmousecontrol="false"
	               title="true"
	               thumbs="true"
	               thumbs_width="120" thumbs_height="80" thumbs_padding="10" thumbs_crop="0|40|240|160"
	               thumbs_opened="false"
	               thumbs_text="false"
	               thumbs_dragging="true"
	               thumbs_onhoverscrolling="false"
	               thumbs_scrollbuttons="false"
	               thumbs_scrollindicator="false"
	               thumbs_loop="false"
	               tooltips_buttons="false"
	               tooltips_thumbs="false"
	               tooltips_hotspots="false"
	               tooltips_mapspots="false"
	               deeplinking="false"
	               loadscene_flags="MERGE"
	               loadscene_blend="OPENBLEND(0.5, 0.0, 0.75, 0.05, linear)"
	               loadscene_blend_prev="SLIDEBLEND(0.5, 180, 0.75, linear)"
	               loadscene_blend_next="SLIDEBLEND(0.5,   0, 0.75, linear)"
	               loadingtext=""
	               layout_width="100%"
	               layout_maxwidth="814"
	               controlbar_width="-24"
	               controlbar_height="40"
	               controlbar_offset="20"
	               controlbar_offset_closed="-40"
	               controlbar_overlap.no-fractionalscaling="10"
	               controlbar_overlap.fractionalscaling="0"
	               design_skin_images="vtourskin.png"
	               design_bgcolor="0x2D3E50"
	               design_bgalpha="0.8"
	               design_bgborder="0"
	               design_bgroundedge="1"
	               design_bgshadow="0 4 10 0x000000 0.3"
	               design_thumbborder_bgborder="3 0xFFFFFF 1.0"
	               design_thumbborder_padding="2"
	               design_thumbborder_bgroundedge="0"
	               design_text_css="color:#FFFFFF; font-family:Arial;"
	               design_text_shadow="1"
	               />

    <style name="hotspot_ani_white"
	       url="skin/hotspot_ani_white.png"
	       crop="0|0|64|64"
	       frames="20" framewidth="64" frameheight="64" frame="0"
	       onloaded="hotspot_animate();"
	       />
	
	<!-- randomize the autorotation horison setting every 4 seconds -->
	<action name="randomizehorizon" autorun="onstart">
		calc(autorotate.horizon, (random - 0.5) * 180.0);
		delayedcall(4, randomizehorizon() );
	</action> 

	<!-- define the actions for projection changes with animation -->
    <action name="setprojection">
        <!-- %1 is the projection type -->
        tween(view.fov, 120, 1.0, easeInOutQuad);
        tween(view.vlookat, 0, 1.0, easeInOutQuad);
        wait(1.0);
        set(view.projection, %1);
        tween(view.fov, 90, 1.0, easeInOutQuad);
    </action>

	<action name="hotspot_animate">
		if(loaded,
			inc(frame,1,get(frames),0);
			mul(ypos,frame,frameheight);
			txtadd(crop,'0|',get(ypos),'|',get(framewidth),'|',get(frameheight));
			delayedcall(0.1, hotspot_animate() );
		  );
	</action>

	<action name="scene3dtransition" scope="local" args="scenename, hlookatoffset">
        transitiontime = 1;
        transitiontweentype = "easeinoutexpo";
		loadscene(get(scenename), null, MERGE|PRELOAD, BLEND(get(transitiontime),get(transitiontweentype)));
	</action>

	<action name="show_gyro_help">
    set(layer[gyro_icon].visible, true);
    set(layer[gyro_text].visible, true);

    tween(layer[gyro_icon].alpha, 1, 0.5);
    tween(layer[gyro_text].alpha, 1, 0.5);

    delayedcall(4, hide_gyro_help());
    </action>

   <action name="hide_gyro_help">
    tween(layer[gyro_icon].alpha, 0, 0.5, default, set(layer[gyro_icon].visible,false));
    tween(layer[gyro_text].alpha, 0, 0.5, default, set(layer[gyro_text].visible,false));
    </action>

	<events onstart="show_gyro_help();" />
   
   <layer name="gyro_bg"
       type="container"
       width="50"
       height="50"
       bgcolor="0x000000"
       bgalpha="0.7"
       align="topcenter"
       y="50"
       keep.mobile="true"
       enabled="false"
       visible.mobile="true"
    />

   <!-- Icon image -->
    <layer name="gyro_icon"
       parent="gyro_bg"
       url="skin/vtourskin1.png"
       align="center"
       scale="0.6"
       keep="true"
       onclick="plugin[gyro].toggleenabled();"
    />
	
	<layer name="gyro_text"
       type="text"
       css="color:#FFFFFF;text-align:center;font-size:20px;"
       bg="true" bgalpha="0.5" bgcolor="0x000000"
       txtshadow="0 1 4 0x000000 1.0"
       align="topcenter"
       y="100"
	   width="350"
	   width.mobile="250"
       html="Tap the Gyro Icon first, &#10;then move your phone to look around"
       visible.mobile="true"
       keep.mobile="true"
	   	edges="Edges"
		spacing="Spacing"

     />

    <contextmenu fullscreen="true" versioninfo="true" customstyle="true">
        top-level title (optional)
        <item caption="Control Mode:" enabled="false" separator="true" />

        <item caption="- Drag to Rotate -" onclick="set(control.mode, drag);" />
        <item caption="- Move / Walk Mode -" onclick="set(control.mode, moveto);" />
        <item caption="- Look Around -" onclick="set(control.mode, lookat);" />

        <item caption="" separator="true" /> 

        <item caption="Normal View" onclick="setprojection(normal);" />
        <item caption="Fisheye View" onclick="setprojection(fisheye);" />
        <item caption="Architectural View" onclick="setprojection(stereographic);" />
        <item caption="Little Planet" onclick="setprojection(architectural);" />
        <item caption="Panini View" onclick="setprojection(panini);" />
    </contextmenu>

 <scene name="scene_05" title="05" onstart="" thumburl="panos/05.tiles/thumb.jpg" lat="0.00000000" lng="0.00000000" alt="0.00" heading="0.0">
     <control bouncinglimits="calc:image.cube ? true : false"/>
     <view hlookat="0.0" vlookat="0.0" fovtype="MFOV" fov="120" maxpixelzoom="2.0" fovmin="70" fovmax="140" limitview="auto"/>
     <preview url="panos/05.tiles/preview.jpg"/>
     <image>
     <cube url="panos/05.tiles/%s/l%l/%v/l%l_%s_%v_%h.jpg" multires="512,1024,2048,3840"/>
     </image>
	 <hotspot name="spot2" style="hotspot_ani_white" ath="-0.822" atv="23.971" depth="1000" prealign="true" onclick="scene3dtransition(scene_06);" />
 </scene> 

  <scene name="scene_06" title="06" onstart="" thumburl="panos/06.tiles/thumb.jpg" lat="0.00000000" lng="0.00000000" alt="0.00" heading="0.0">
     <control bouncinglimits="calc:image.cube ? true : false"/>
     <view hlookat="0.0" vlookat="0.0" fovtype="MFOV" fov="120" maxpixelzoom="2.0" fovmin="70" fovmax="140" limitview="auto"/>
     <preview url="panos/06.tiles/preview.jpg"/>
     <image>
     <cube url="panos/06.tiles/%s/l%l/%v/l%l_%s_%v_%h.jpg" multires="512,1024,2048,3840"/>
     </image>
 </scene> 

</krpano>
